/*
 * Retrieves all shipments from the [Shipments] table in the [logistics] database,
 * and includes their associated packages from the [Packages] table.
 *
 * ğŸ”¹ [include] serves as a **loop mechanism**:
 * - Iterates through each shipment.
 * - For every shipment, runs a [data.read] on [Packages] using [ShipmentId].
 *
 * ğŸ”¹ The [yield] inside [include] is mandatory:
 * - It ensures that the packages retrieved are appended to each shipment.
 * - Without it, the response would include shipments but no nested package info.
 *
 * ğŸ”¸ Ideal for:
 * 1. API endpoints that return complex transport data.
 * 2. Aggregated dashboards showing shipment â†’ package structure.
 * 3. Exporting relational records in nested formats.
 */
data.connect:logistics
   data.read
      table:Shipments
   include:x:@data.read/*
      data.read
         table:Packages
         where
            and
               ShipmentId.eq:x:@.dp/#/*/ShipmentId
      yield
         packages:x:@data.read/*
