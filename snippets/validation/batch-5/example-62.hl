/*
 * Returns product records from the [shopDB] database.
 *
 * Accepts an optional [category.eq] argument. If provided, the result will include
 * only products matching the given category. Otherwise, the query returns all products.
 *
 * The [add] ensures dynamic filtering logic is only included if input is present.
 */
.arguments
   category.eq:string

data.connect:shopDB

   add:x:@data.connect/*/data.read/*/where/*/and
      get-nodes:x:@.arguments/*/category.eq
   data.read
      table:Products
      limit:10
      where
         and
   yield
      products:x:@data.read/*
