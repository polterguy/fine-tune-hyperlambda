
// Write Hyperlambda code that connects to the [magic] database using [data.connect], then executes a custom SQL select statement via [data.select] to retrieve the maximum [completion] value for each [prompt] from the [ml_requests] table, filtered by [user_id], [questionnaire] = 1, and [context] = 1, grouping by [prompt]. The [user_id] should be passed as a parameter from [.arguments/*/user_id]. For every result returned by [data.select], add two new nodes to the [.session] node: one as an assistant message with [role] set to "assistant" and [content] set to the [prompt] value, and one as a user message with [role] set to "user" and [content] set to the [completion] value. Use [for-each] to process each record, [unwrap] to evaluate expressions, and [add] to insert nodes under [.session].
data.connect:[generic|magic]
   data.select:"\nselect prompt, max(completion) as completion\n   from ml_requests\n   where user_id = @user_id and questionnaire = 1 and context = 1\n   group by prompt"
      user_id:x:@.arguments/*/user_id
   for-each:x:@data.select/*
      unwrap:x:+/*/*/*/content
      add:x:@.session
         .
            .
               role:assistant
               content:x:@.dp/#/*/prompt
      unwrap:x:+/*/*/*/content
      add:x:@.session
         .
            .
               role:user
               content:x:@.dp/#/*/completion
