
// This Hyperlambda code iterates over the result of a SQL select query, processing each node to extract and transform database column metadata. It uses [unwrap] to evaluate expressions, [if] to set automatic flags based on default values, and [switch] to map SQL data types to Hyperlambda types. The processed metadata is then added to a temporary node and merged with a connection node's return data. Key slots include [for-each] for iteration, [unwrap] for expression evaluation, [if] for conditional logic, and [switch] for type mapping.
for-each:x:@mssql.select/*
   unwrap:x:+/*/*
   .tmp
      ""
         name:x:@.dp/#/*/name
         db:x:@.dp/#/*/type
         nullable:x:@.dp/#/*/nullable
         primary:x:@.dp/#/*/primary
         automatic:x:@.dp/#/*/automatic
   if
      mt
         get-value:x:@.dp/#/*/default
         .:int:0
      .lambda
         set-value:x:@.tmp/*/*/automatic
            .:bool:true
   .type
   switch:x:@.dp/#/*/type
      case:date
      case:datetime
      case:datetime2
      case:datetimeoffset
      case:smalldatetime
      case:time
         set-value:x:@.type
            .:date
      case:numeric
      case:decimal
      case:smallmoney
      case:money
      case:float
      case:real
         set-value:x:@.type
            .:decimal
      case:bigint
      case:smallint
      case:int
      case:tinyint
         set-value:x:@.type
            .:long
      case:bit
         set-value:x:@.type
            .:bool
      case:char
      case:varchar
      case:text
      case:nchar
      case:nvarchar
      case:ntext
      case:binary
      case:image
      case:varbinary
      case:uniqueidentifier
         set-value:x:@.type
            .:string
      case:rowversion
      case:timestamp
         set-value:x:@.type
            .:string
         set-value:x:@.tmp/*/*/automatic
            .:bool:true
      default
         set-value:x:@.type
            .:string
   unwrap:x:+/*/*
   add:x:@.tmp/*
      .
         hl:x:@.type
   add:x:../*/mssql.connect/*/return-nodes
      get-nodes:x:@.tmp/*
