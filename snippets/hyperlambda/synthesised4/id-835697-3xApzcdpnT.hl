
// This Hyperlambda code constructs a SQL expression to calculate the number of occurrences of a substring within a field. It uses [strings.concat] to concatenate parts of the SQL expression, including the field name and a placeholder for the substring. The [get-value] slot retrieves values for SQL, fields, and no nodes, which are used to build the expression for counting occurrences by comparing the length of the field before and after replacing the substring. The result is assigned to the [sql] node using [set-value].
set-value:x:@.sql
   strings.concat:x:@.sql
      get-value:x:@.sql
      .:" (length("
      get-value:x:@.fields
      .:) - length(replace(lower(
      get-value:x:@.fields
      .:), @p
      get-value:x:@.no
      .:", ''))) / length(@p"
      get-value:x:@.no
      .:)
