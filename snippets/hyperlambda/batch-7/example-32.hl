/*
 * Exposes an HTTP API endpoint that sends an email message.
 * SMTP credentials are loaded from configuration keys under 'env:mail-server:'.
 * Returns an 'OK' confirmation message upon successful delivery.
 */
.arguments
   name:string
   to:string
   subject:string
   body:string
.mail-server-host
set-value:x:@.mail-server-host
   config.get:"env:mail-server:host"
.mail-server-port
set-value:x:@.mail-server-port
   config.get:"env:mail-server:port"
.mail-server-user
set-value:x:@.mail-server-user
   config.get:"env:mail-server:username"
.mail-server-pass
set-value:x:@.mail-server-pass
   config.get:"env:mail-server:password"
mail.smtp.send
   server
      host:x:@.mail-server-host
      port:x:@.mail-server-port
      username:x:@.mail-server-user
      password:x:@.mail-server-pass
      secure:bool:true
   message
      to
         .
            name:x:@.arguments/*/name
            email:x:@.arguments/*/to
      subject:x:@.arguments/*/subject
      entity:text/plain
         content:x:@.arguments/*/body
return
   result:OK
