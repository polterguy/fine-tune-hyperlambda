/*
 * Defines an HTTP endpoint for email delivery.
 * SMTP details are retrieved from config under 'settings:smtp-config:' prefix.
 * Sends the email and returns 'success'.
 */
.arguments
   name:string
   to:string
   subject:string
   body:string
.h
set-value:x:@.h
   config.get:"settings:smtp-config:host"
.p
set-value:x:@.p
   config.get:"settings:smtp-config:port"
.u
set-value:x:@.u
   config.get:"settings:smtp-config:username"
.pw
set-value:x:@.pw
   config.get:"settings:smtp-config:password"
mail.smtp.send
   server
      host:x:@.h
      port:x:@.p
      username:x:@.u
      password:x:@.pw
      secure:bool:true
   message
      to
         .
            name:x:@.arguments/*/name
            email:x:@.arguments/*/to
      subject:x:@.arguments/*/subject
      entity:text/plain
         content:x:@.arguments/*/body
return
   result:success
